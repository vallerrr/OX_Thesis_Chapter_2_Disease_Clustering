import warnings
from pathlib import Path

import pandas as pd

#  paths
current_path = Path.cwd()
recorder_path = current_path/'Data/downloaded_data/recorder'
codebook_path = current_path/'Data/codebook'
participant_path = current_path/'Data/downloaded_data/participant'
preprocessed_path = current_path/'Data/preprocessed_data'
intermediate_path = current_path/'Data/intermediate_files'
data_path = current_path/'Data/preprocessed_data'
final_data_path = data_path.parent / 'final_data'

# recoding section
cate_names = ['Cognitive function summary', 'Lifestyle', 'Socio-demographics', 'Early life', 'Health outcomes', 'Physical measures', 'Family history', 'Education and employment']
codebook_basic_columns = ['field_name', 'cate_name', 'field_id', 'cate_id', 'original_cat','ids_count', 'instance_count', 'array_count', 'ids', 'instance','array', 'file_names', 'recode_type','replace_dict','preprocessed_flag', 'note']
replace_dict_basics = {'half': 0.5, '6+': 6, '2-4 times a week': 2, 'Once a week': 1, 'Never': 0, '5-6 times a week': 3, 'Once or more daily': 4, 'Sometimes': 2, 'Never/rarely': 0.0, 'Usually': 2.0, 'Always': 3.0, '52,000 to 100,000': 4.0, '18,000 to 30,999': 2.0, 'Greater than 100,000': 5.0, '31,000 to 51,999': 3.0, 'Less than 18,000': 1.0, 'Two': 2.0, 'One': 1.0, 'Three': 3.0, 'Four or more': 4.0, 'Rent - from private landlord or letting agency': 2.5, 'Own outright (by you or someone in your household)': 0.5, 'Own with a mortgage': 1.0, 'Rent - from local authority, local council, housing association': 3.0, 'Live in accommodation rent free': 2.0, 'Pay part rent and part mortgage (shared ownership)': 1.5, 'None of the above': None, 'Mobile or temporary structure (i.e. caravan)': 3.0, 'Sheltered accommodation': 4.0, 'A flat, maisonette or apartment': 2.0, 'A house or bungalow': 1.0, 'Care home': 4.0, 'May': 5.0, 'September': 9.0, 'April': 4.0, 'November': 11.0, 'January': 1.0, 'June': 6.0, 'February': 2.0, 'August': 8.0, 'July': 7.0, 'March': 3.0, 'October': 10.0, 'December': 12.0, 'Female': 0.0, 'Male': 1.0, 'Yes - pounds and ounces': 0.453592, 'Yes - Kilograms': 1.0, 'About average': 1.0, 'Thinner': 0.5, 'Plumper': 2.0, 'Shorter': 0.5, 'Taller': 2.0, 'Right-handed': 3.0, 'Left-handed': 2.0, 'Use both right and left hands equally': 1.0, 'No, I am unable to do this': 0.0, 'I can only hear on the left side': 0.5, 'I can only hear on the right side': 0.5, 'yes': 1.0, 'no': 0.0, 'abandon': 0.0, '10%': 0.1, '20%': 0.2, '40%': 0.4, '70%': 0.7, '100% (max)': 1.0, 'Unreliable due to unexpectedly small size': -1.0, 'Unreliable due to unexpectedly large size': 1.0, 'normal': 0.0, 'high possibility of abnormality': 1.0, 'doubtful': 0.5, 'Unsure': 0.5, 'highly myopic': 1.0, 'moderate/low myopia': 0.5, 'non-myopic': 0.0, 'Less than once a week': 0.5, 'Less than a year': 0.5, '3 or 4': 3.5, '1 or 2': 1.5, '7, 8 or 9': 8.0, '5 or 6': 5.5, '10 or more': 10.0, 'Yes, but not in the last year': 0.5, 'Yes, during the last year': 1.0, 'Less than monthly': 0.1, 'Monthly': 0.25, 'Weekly': 1.0, 'Daily or almost daily': 7.0, '4 or more times a week': 4.5, '2 to 3 times a week': 2.5, '2 to 4 times a month': 0.375, 'Monthly or less': 0.25, "['Talking therapies, such as psychotherapy, counselling, group therapy or CBT']": 1.0, "['Talking therapies, such as psychotherapy, counselling, group therapy or CBT', 'Other therapeutic activities such as mindfulness, yoga or art classes']": 1.0, "['Other therapeutic activities such as mindfulness, yoga or art classes']": 1.0, 'Rarely': 1.0, 'A little': 1.0, 'Somewhat': 2.0, 'A lot': 3.0, 'All my life / as long as I can remember': 500.0, 'Several days': 1.0, 'Nearly every day': 3.0, 'More than half the days': 2.0, 'Yes, more than 100 times': 6.0, 'Yes, 1-2 times': 1.0, 'Yes, 3-10 times': 2.0, 'Yes, 11-100 times': 3.0, 'Once a week or more, but not every day': 3.0, 'Less than once a month': 0.25, 'Once a month or more, but not every week': 0.75, "['Prefer not to answer']": None, 'Not applicable': 0.0, 'Between one and three months': 2.0, 'One to two years': 18.0, 'Over two years': 24.0, 'Over six months, but less than 12 months': 10.0, 'Less than a month': 0.1, 'Over three months, but less than six months': 0.4, 'All day long': 1.0, 'About half of the day': 0.5, 'Most of the day': 0.8, 'Less than half of the day': 0.3, "['Unprescribed medication (more than once)']": 1.0, "['Drugs or alcohol (more than once)']": -1.0, "['Unprescribed medication (more than once)', 'Medication prescribed to you (for at least two weeks)']": 1.0, "['Unprescribed medication (more than once)', 'Medication prescribed to you (for at least two weeks)', 'Drugs or alcohol (more than once)']": 0.0, "['Medication prescribed to you (for at least two weeks)', 'Drugs or alcohol (more than once)']": 0.0, "['Medication prescribed to you (for at least two weeks)']": 1.0, "['Unprescribed medication (more than once)', 'Drugs or alcohol (more than once)']": -1.0, 'Stayed about the same or was on a diet': 0.0, 'Both gained and lost some weight during the episode': 1.0, 'Gained weight': 1.0, 'Lost weight': 1.0, 'Not bothered at all': 0.0, 'Bothered a lot': 2.0, 'Bothered a little': 1.0, '0 - Not at all': 0.0, '10 - Completely': 10.0, 'Most of the time': 2.5, 'Two to three days a month': 0.5, 'One day a month': 0.25, 'Every day': 7.0, 'Less than one day a month': 0.1, 'One day a week': 1.0, 'More than one day a week': 3.0, '5 days with pain': 5.0, '2 days with pain': 2.0, '7 days with pain': 7.0, '9 days with pain': 9.0, '10 days with pain': 10.0, '3 days with pain': 3.0, '8 days with pain': 8.0, '6 days with pain': 6.0, '1 day with pain': 1.0, '4 days with pain': 4.0, 'No days with pain': 0.0, '10 - Very unhappy': 10.0, '0 - Very happy': 0.0, '0 - No distension': 0.0, '10 - Very severe distension': 10.0, '10 - Very severe pain': 10.0, '0 - No pain': 0.0, 'Right eye only': 1.0, 'Left eye only': 1.0, 'Both eyes': 2.0, 'Yes, but more than 4 weeks ago': 2.0, 'Yes, in last 4 weeks': 3.0, 'Possibly, but more than 4 weeks ago': 1.0, "['Diabetes related eye disease', 'Injury or trauma resulting in loss of vision', 'Macular degeneration', 'Other serious eye condition']": 1.0, "['Glaucoma', 'Injury or trauma resulting in loss of vision', 'Cataract', 'Macular degeneration']": 1.0, "['Glaucoma', 'Injury or trauma resulting in loss of vision']": 1.0, "['Diabetes related eye disease', 'Glaucoma', 'Macular degeneration']": 1.0, "['Glaucoma', 'Injury or trauma resulting in loss of vision', 'Cataract', 'Macular degeneration', 'Other serious eye condition']": 1.0, "['Glaucoma', 'Cataract', 'Macular degeneration']": 1.0, "['Diabetes related eye disease', 'Glaucoma', 'Cataract', 'Other serious eye condition']": 1.0, "['Macular degeneration']": 1.0, "['Glaucoma', 'Cataract']": 1.0, "['Cataract', 'Other serious eye condition']": 1.0, "['Diabetes related eye disease', 'Injury or trauma resulting in loss of vision', 'Cataract', 'Other serious eye condition']": 1.0, "['Diabetes related eye disease', 'Injury or trauma resulting in loss of vision', 'Cataract']": 1.0, "['Cataract', 'Macular degeneration', 'Other serious eye condition']": 1.0, 'Do not remember': 30.9, 'Still taking HRT': 1.0, 'Still taking the pill': 1.0, 'Not sure': None, 'Only had twins': 7.01, 'Less than 1 year ago': 0.5, 'Less than a year ago': 0.5, 'Only one fall': 1.0, 'No falls': 0.0, 'More than one fall': 2.0, 'Good': 2.0, 'Excellent': 3.0, 'Poor': 0.0, 'Fair': 1.0, 'No - weigh about the same': 0.0, 'Yes - lost weight': -1.0, 'Yes - gained weight': 1.0, 'A moderate amount': 2.0, 'An extreme amount': 4.0, 'Very much': 3.0, 'Moderately happy': 1.0, 'Very unhappy': -2.0, 'Moderately unhappy': -1.0, 'Extremely unhappy': -3.0, 'Extremely happy': 3.0, 'Very happy': 2.0, 'I am completely deaf': 2.0, 'Yes, for around 1-5 years': 2.0, 'Yes, for more than 5 years': 3.0, 'Yes, for less than a year': 1.0, 'Yes, now a lot of the time': 3.0, 'No, never': 0.0, 'Yes, but not now, but have in the past': 1.0, 'Yes, now some of the time': 2.0, 'Yes, now most or all of the time': 4.0, 'Severely': 3.0, 'Slightly': 1.0, 'A week or more': 7.0, 'At least a day, but less than a week': 3.5, 'Less than 24 hours': 1.0, 'No problems': 0.0, 'Needed treatment or caused problems with work, relationships, finances, the law or other aspects of life.': 1.0, 'Yes - you will be asked about this later by an interviewer': 1.0, 'No cigarettes, only smoke cigars or pipes': 0.0, 'Less than one cigarette per day': 0.5, 'At least two days, but less than a week': 3.5, 'Less than a week': 3.0, 'Needed treatment or caused problems with work, relationships, finances, the law or other aspects of life': 1.0, 'No': 0.0, 'Yes': 1.0, 'Do not know': None, 'Yes, more than once': 2.0, 'Yes, once': 1.0, '3 or more': 3.0, "['Yes']": 1.0, "['Yes', 'No']": 0.5, "['Yes', 'No', 'Not known']": 0.5, "['Not known']": 0.0, "['Yes', 'Not known']": 0.75, "['No']": 0.0, "['No', 'Not known']": 0.0, 'Never true': 0.0, 'Very often true': 4.0, 'Prefer not to answer': None, 'Sometimes true': 2.0, 'Often': 3.0, 'Rarely true': 1.0, 'Yes, within the last 12 months': 1.0, 'Yes, but not in the last 12 months': 2.0, 'Not at all': 0.0, 'A little bit': 1.0, 'Moderately': 3.0, 'Extremely': 4.0, 'Quite a bit': 2.0, 'Too many to count': 80.0}
job_code_dict = {'Corporate Managers': 'Managers and Senior Officials', 'Corporate Managers And Senior Officials': 'Managers and Senior Officials', 'Senior officials in national government': 'Managers and Senior Officials', 'Directors and chief executives of major organisations': 'Managers and Senior Officials', 'Senior officials in local government': 'Managers and Senior Officials', 'Senior officials of special interest organisations': 'Managers and Senior Officials', 'Production Managers': 'Managers and Senior Officials', 'Production, works and maintenance managers': 'Managers and Senior Officials', 'Managers in construction': 'Managers and Senior Officials', 'Managers in mining and energy': 'Managers and Senior Officials', 'Functional Managers': 'Managers and Senior Officials', 'Financial managers and chartered secretaries': 'Managers and Senior Officials', 'Marketing and sales managers': 'Managers and Senior Officials', 'Purchasing managers': 'Managers and Senior Officials', 'Advertising and public relations managers': 'Managers and Senior Officials', 'Personnel, training and industrial relations managers': 'Managers and Senior Officials', 'Information and communication technology managers': 'Managers and Senior Officials', 'Research and development managers': 'Managers and Senior Officials', 'Quality And Customer Care Managers': 'Managers and Senior Officials', 'Quality assurance managers': 'Managers and Senior Officials', 'Customer care managers': 'Managers and Senior Officials', 'Financial Institution And Office Managers': 'Managers and Senior Officials', 'Financial institution managers': 'Managers and Senior Officials', 'Office managers': 'Managers and Senior Officials', 'Managers In Distribution, Storage And Retailing': 'Managers and Senior Officials', 'Transport and distribution managers': 'Managers and Senior Officials', 'Storage and warehouse managers': 'Managers and Senior Officials', 'Retail and wholesale managers': 'Managers and Senior Officials', 'Protective Service Officers': 'Managers and Senior Officials', 'Officers in armed forces': 'Managers and Senior Officials', 'Police officers (inspectors and above)': 'Managers and Senior Officials', 'Senior officers in fire, ambulance, prison and related services': 'Managers and Senior Officials', 'Security managers': 'Managers and Senior Officials', 'Health And Social Services Managers': 'Managers and Senior Officials', 'Hospital and health service managers': 'Managers and Senior Officials', 'Pharmacy managers': 'Managers and Senior Officials', 'Healthcare practice managers': 'Managers and Senior Officials', 'Social services managers': 'Managers and Senior Officials', 'Residential and day care managers': 'Managers and Senior Officials', 'Managers And Proprietors In Agriculture And Services': 'Managers and Senior Officials', 'Managers In Farming, Horticulture, Forestry And Fishing': 'Managers and Senior Officials', 'Farm managers': 'Managers and Senior Officials', 'Natural environment and conservation managers': 'Managers and Senior Officials', 'Managers in animal husbandry, forestry and fishing n.e.c.': 'Managers and Senior Officials', 'Managers And Proprietors In Hospitality And Leisure Services': 'Managers and Senior Officials', 'Hotel and accommodation managers': 'Managers and Senior Officials', 'Conference and exhibition managers': 'Managers and Senior Officials', 'Restaurant and catering managers': 'Managers and Senior Officials', 'Publicans and managers of licensed premises': 'Managers and Senior Officials', 'Leisure and sports managers': 'Managers and Senior Officials', 'Travel agency managers': 'Managers and Senior Officials', 'Managers And Proprietors In Other Service Industries': 'Managers and Senior Officials', 'Property, housing and land managers': 'Managers and Senior Officials', 'Garage managers and proprietors': 'Managers and Senior Officials', 'Hairdressing and beauty salon managers and proprietors': 'Managers and Senior Officials', 'Shopkeepers and wholesale/retail dealers': 'Managers and Senior Officials', 'Recycling and refuse disposal managers': 'Managers and Senior Officials', 'Managers and proprietors in other services n.e.c.': 'Managers and Senior Officials', 'Science And Technology Professionals': 'Professional Occupations', 'Science Professionals': 'Professional Occupations', 'Chemists': 'Professional Occupations', 'Biological scientists and biochemists': 'Professional Occupations', 'Physicists, geologists and meteorologists': 'Professional Occupations', 'Engineering Professionals': 'Professional Occupations', 'Civil engineers': 'Professional Occupations', 'Mechanical engineers': 'Professional Occupations', 'Electrical engineers': 'Professional Occupations', 'Electronics engineers': 'Professional Occupations', 'Chemical engineers': 'Professional Occupations', 'Design and development engineers': 'Professional Occupations', 'Production and process engineers': 'Professional Occupations', 'Planning and quality control engineers': 'Professional Occupations', 'Engineering professionals n.e.c.': 'Professional Occupations', 'Information And Communication Technology Professionals': 'Professional Occupations', 'IT strategy and planning professionals': 'Professional Occupations', 'Software professionals': 'Professional Occupations', 'Health Professionals': 'Professional Occupations', 'Medical practitioners': 'Professional Occupations', 'Psychologists': 'Professional Occupations', 'Pharmacists/pharmacologists': 'Professional Occupations', 'Ophthalmic opticians': 'Professional Occupations', 'Dental practitioners': 'Professional Occupations', 'Veterinarians': 'Professional Occupations', 'Teaching And Research Professionals': 'Professional Occupations', 'Teaching Professionals': 'Professional Occupations', 'Higher education teaching professionals': 'Professional Occupations', 'Further education teaching professionals': 'Professional Occupations', 'Education officers, school inspectors': 'Professional Occupations', 'Secondary education teaching professionals': 'Professional Occupations', 'Primary and nursery education teaching professionals': 'Professional Occupations', 'Special needs education teaching professionals': 'Professional Occupations', 'Registrars and senior administrators of educational establishments': 'Professional Occupations', 'Teaching professionals n.e.c.': 'Professional Occupations', 'Research Professionals': 'Professional Occupations', 'Scientific researchers': 'Professional Occupations', 'Social science researchers': 'Professional Occupations', 'Researchers n.e.c.': 'Professional Occupations', 'Business And Public Service Professionals': 'Professional Occupations', 'Legal Professionals': 'Professional Occupations', 'Solicitors and lawyers, judges and coroners': 'Professional Occupations', 'Legal professionals n.e.c.': 'Professional Occupations', 'Business And Statistical Professionals': 'Professional Occupations', 'Chartered and certified accountants': 'Professional Occupations', 'Management accountants': 'Professional Occupations', 'Management consultants, actuaries, economists and statisticians': 'Professional Occupations', 'Architects, Town Planners, Surveyors': 'Professional Occupations', 'Architects': 'Professional Occupations', 'Town planners': 'Professional Occupations', 'Quantity surveyors': 'Professional Occupations', 'Chartered surveyors (not quantity surveyors)': 'Professional Occupations', 'Public Service Professionals': 'Professional Occupations', 'Public service administrative professionals': 'Professional Occupations', 'Social workers': 'Professional Occupations', 'Probation officers': 'Professional Occupations', 'Clergy': 'Professional Occupations', 'Librarians And Related Professionals': 'Professional Occupations', 'Librarians': 'Professional Occupations', 'Archivists and curators': 'Professional Occupations', 'Science And Technology Associate Professionals': 'Associate Professional and Technical Occupations', 'Science And Engineering Technicians': 'Associate Professional and Technical Occupations', 'Laboratory technicians': 'Associate Professional and Technical Occupations', 'Electrical/electronics technicians': 'Associate Professional and Technical Occupations', 'Engineering technicians': 'Associate Professional and Technical Occupations', 'Building and civil engineering technicians': 'Associate Professional and Technical Occupations', 'Quality assurance technicians': 'Associate Professional and Technical Occupations', 'Science and engineering technicians n.e.c.': 'Associate Professional and Technical Occupations', 'Draughtspersons And Building Inspectors': 'Associate Professional and Technical Occupations', 'Architectural technologists and town planning technicians': 'Associate Professional and Technical Occupations', 'Draughtspersons': 'Associate Professional and Technical Occupations', 'Building inspectors': 'Associate Professional and Technical Occupations', 'IT Service Delivery Occupations': 'Associate Professional and Technical Occupations', 'IT operations technicians': 'Associate Professional and Technical Occupations', 'IT user support technicians': 'Associate Professional and Technical Occupations', 'Health And Social Welfare Associate Professionals': 'Associate Professional and Technical Occupations', 'Health Associate Professionals': 'Associate Professional and Technical Occupations', 'Nurses': 'Associate Professional and Technical Occupations', 'Midwives': 'Associate Professional and Technical Occupations', 'Paramedics': 'Associate Professional and Technical Occupations', 'Medical radiographers': 'Associate Professional and Technical Occupations', 'Chiropodists': 'Associate Professional and Technical Occupations', 'Dispensing opticians': 'Associate Professional and Technical Occupations', 'Pharmaceutical dispensers': 'Associate Professional and Technical Occupations', 'Medical and dental technicians': 'Associate Professional and Technical Occupations', 'Therapists': 'Associate Professional and Technical Occupations', 'Physiotherapists': 'Associate Professional and Technical Occupations', 'Occupational therapists': 'Associate Professional and Technical Occupations', 'Speech and language therapists': 'Associate Professional and Technical Occupations', 'Therapists n.e.c.': 'Associate Professional and Technical Occupations', 'Social Welfare Associate Professionals': 'Associate Professional and Technical Occupations', 'Youth and community workers': 'Associate Professional and Technical Occupations', 'Housing and welfare officers': 'Associate Professional and Technical Occupations', 'Protective Service Occupations': 'Associate Professional and Technical Occupations', 'NCOs and other ranks': 'Associate Professional and Technical Occupations', 'Police officers (sergeant and below)': 'Associate Professional and Technical Occupations', 'Fire service officers (leading fire officer and below)': 'Associate Professional and Technical Occupations', 'Prison service officers (below principal officer)': 'Associate Professional and Technical Occupations', 'Protective service associate professionals n.e.c.': 'Associate Professional and Technical Occupations', 'Culture, Media And Sports Occupations': 'Associate Professional and Technical Occupations', 'Artistic And Literary Occupations': 'Associate Professional and Technical Occupations', 'Artists': 'Associate Professional and Technical Occupations', 'Authors, writers': 'Associate Professional and Technical Occupations', 'Actors, entertainers': 'Associate Professional and Technical Occupations', 'Dancers and choreographers': 'Associate Professional and Technical Occupations', 'Musicians': 'Associate Professional and Technical Occupations', 'Arts officers, producers and directors': 'Associate Professional and Technical Occupations', 'Design Associate Professionals': 'Associate Professional and Technical Occupations', 'Graphic designers': 'Associate Professional and Technical Occupations', 'Product, clothing and related designers': 'Associate Professional and Technical Occupations', 'Media Associate Professionals': 'Associate Professional and Technical Occupations', 'Journalists, newspaper and periodical editors': 'Associate Professional and Technical Occupations', 'Broadcasting associate professionals': 'Associate Professional and Technical Occupations', 'Public relations officers': 'Associate Professional and Technical Occupations', 'Photographers and audio-visual equipment operators': 'Associate Professional and Technical Occupations', 'Sports And Fitness Occupations': 'Associate Professional and Technical Occupations', 'Sports players': 'Associate Professional and Technical Occupations', 'Sports coaches, instructors and officials': 'Associate Professional and Technical Occupations', 'Fitness instructors': 'Associate Professional and Technical Occupations', 'Sports and fitness occupations n.e.c.': 'Associate Professional and Technical Occupations', 'Business And Public Service Associate Professionals': 'Associate Professional and Technical Occupations', 'Transport Associate Professionals': 'Associate Professional and Technical Occupations', 'Air traffic controllers': 'Associate Professional and Technical Occupations', 'Aircraft pilots and flight engineers': 'Associate Professional and Technical Occupations', 'Ship and hovercraft officers': 'Associate Professional and Technical Occupations', 'Train drivers': 'Associate Professional and Technical Occupations', 'Legal Associate Professionals': 'Associate Professional and Technical Occupations', 'Legal associate professionals': 'Associate Professional and Technical Occupations', 'Business And Finance Associate Professionals': 'Associate Professional and Technical Occupations', 'Estimators, valuers and assessors': 'Associate Professional and Technical Occupations', 'Brokers': 'Associate Professional and Technical Occupations', 'Insurance underwriters': 'Associate Professional and Technical Occupations', 'Finance and investment analysts/advisers': 'Associate Professional and Technical Occupations', 'Taxation experts': 'Associate Professional and Technical Occupations', 'Importers, exporters': 'Associate Professional and Technical Occupations', 'Financial and accounting technicians': 'Associate Professional and Technical Occupations', 'Business and related associate professionals n.e.c.': 'Associate Professional and Technical Occupations', 'Sales And Related Associate Professionals': 'Associate Professional and Technical Occupations', 'Buyers and purchasing officers': 'Associate Professional and Technical Occupations', 'Sales representatives': 'Associate Professional and Technical Occupations', 'Marketing associate professionals': 'Associate Professional and Technical Occupations', 'Estate agents, auctioneers': 'Associate Professional and Technical Occupations', 'Conservation Associate Professionals': 'Associate Professional and Technical Occupations', 'Conservation and environmental protection officers': 'Associate Professional and Technical Occupations', 'Countryside and park rangers': 'Associate Professional and Technical Occupations', 'Public Service And Other Associate Professionals': 'Associate Professional and Technical Occupations', 'Public service associate professionals': 'Associate Professional and Technical Occupations', 'Personnel and industrial relations officers': 'Associate Professional and Technical Occupations', 'Vocational and industrial trainers and instructors': 'Associate Professional and Technical Occupations', 'Careers advisers and vocational guidance specialists': 'Associate Professional and Technical Occupations', 'Inspectors of factories, utilities and trading standards': 'Associate Professional and Technical Occupations', 'Statutory examiners': 'Associate Professional and Technical Occupations', 'Occupational hygienists and safety officers (health and safety)': 'Associate Professional and Technical Occupations', 'Environmental health officers': 'Associate Professional and Technical Occupations', 'Administrative Occupations': 'Administrative and Secretarial Occupations', 'Administrative Occupations: Government And Related Organisations': 'Administrative and Secretarial Occupations', 'Civil Service executive officers': 'Administrative and Secretarial Occupations', 'Civil Service administrative officers and assistants': 'Administrative and Secretarial Occupations', 'Local government clerical officers and assistants': 'Administrative and Secretarial Occupations', 'Officers of non-governmental organisations': 'Administrative and Secretarial Occupations', 'Administrative Occupations: Finance': 'Administrative and Secretarial Occupations', 'Credit controllers': 'Administrative and Secretarial Occupations', 'Accounts and wages clerks, book-keepers, other financial clerks': 'Administrative and Secretarial Occupations', 'Counter clerks': 'Administrative and Secretarial Occupations', 'Administrative Occupations: Records': 'Administrative and Secretarial Occupations', 'Filing and other records assistants/clerks': 'Administrative and Secretarial Occupations', 'Pensions and insurance clerks': 'Administrative and Secretarial Occupations', 'Stock control clerks': 'Administrative and Secretarial Occupations', 'Transport and distribution clerks': 'Administrative and Secretarial Occupations', 'Library assistants/clerks': 'Administrative and Secretarial Occupations', 'Database assistants/clerks': 'Administrative and Secretarial Occupations', 'Market research interviewers': 'Administrative and Secretarial Occupations', 'Administrative Occupations: Communications': 'Administrative and Secretarial Occupations', 'Telephonists': 'Administrative and Secretarial Occupations', 'Communication operators': 'Administrative and Secretarial Occupations', 'Administrative Occupations: General': 'Administrative and Secretarial Occupations', 'General office assistants/clerks': 'Administrative and Secretarial Occupations', 'Secretarial And Related Occupations': 'Administrative and Secretarial Occupations', 'Medical secretaries': 'Administrative and Secretarial Occupations', 'Legal secretaries': 'Administrative and Secretarial Occupations', 'School secretaries': 'Administrative and Secretarial Occupations', 'Company secretaries': 'Administrative and Secretarial Occupations', 'Personal assistants and other secretaries': 'Administrative and Secretarial Occupations', 'Receptionists': 'Administrative and Secretarial Occupations', 'Typists': 'Administrative and Secretarial Occupations', 'Skilled Agricultural Trades': 'Skilled Trades Occupations', 'Agricultural Trades': 'Skilled Trades Occupations', 'Farmers': 'Skilled Trades Occupations', 'Horticultural trades': 'Skilled Trades Occupations', 'Gardeners and groundsmen/groundswomen': 'Skilled Trades Occupations', 'Agricultural and fishing trades n.e.c.': 'Skilled Trades Occupations', 'Skilled Metal And Electrical Trades': 'Skilled Trades Occupations', 'Metal Forming, Welding And Related Trades': 'Skilled Trades Occupations', 'Smiths and forge workers': 'Skilled Trades Occupations', 'Moulders, core makers, die casters': 'Skilled Trades Occupations', 'Sheet metal workers': 'Skilled Trades Occupations', 'Metal plate workers, shipwrights, riveters': 'Skilled Trades Occupations', 'Welding trades': 'Skilled Trades Occupations', 'Pipe fitters': 'Skilled Trades Occupations', 'Metal Machining, Fitting And Instrument Making Trades': 'Skilled Trades Occupations', 'Metal machining setters and setter-operators': 'Skilled Trades Occupations', 'Tool makers, tool fitters and markers-out': 'Skilled Trades Occupations', 'Metal working production and maintenance fitters': 'Skilled Trades Occupations', 'Precision instrument makers and repairers': 'Skilled Trades Occupations', 'Vehicle Trades': 'Skilled Trades Occupations', 'Motor mechanics, auto engineers': 'Skilled Trades Occupations', 'Vehicle body builders and repairers': 'Skilled Trades Occupations', 'Auto electricians': 'Skilled Trades Occupations', 'Vehicle spray painters': 'Skilled Trades Occupations', 'Electrical Trades': 'Skilled Trades Occupations', 'Electricians, electrical fitters': 'Skilled Trades Occupations', 'Telecommunications engineers': 'Skilled Trades Occupations', 'Lines repairers and cable jointers': 'Skilled Trades Occupations', 'TV, video and audio engineers': 'Skilled Trades Occupations', 'Computer engineers, installation and maintenance': 'Skilled Trades Occupations', 'Electrical/electronics engineers n.e.c.': 'Skilled Trades Occupations', 'Skilled Construction And Building Trades': 'Skilled Trades Occupations', 'Construction Trades': 'Skilled Trades Occupations', 'Steel erectors': 'Skilled Trades Occupations', 'Bricklayers, masons': 'Skilled Trades Occupations', 'Roofers, roof tilers and slaters': 'Skilled Trades Occupations', 'Plumbers, heating and ventilating engineers': 'Skilled Trades Occupations', 'Carpenters and joiners': 'Skilled Trades Occupations', 'Glaziers, window fabricators and fitters': 'Skilled Trades Occupations', 'Construction trades n.e.c.': 'Skilled Trades Occupations', 'Building Trades': 'Skilled Trades Occupations', 'Plasterers': 'Skilled Trades Occupations', 'Floorers and wall tilers': 'Skilled Trades Occupations', 'Painters and decorators': 'Skilled Trades Occupations', 'Textiles, Printing And Other Skilled Trades': 'Skilled Trades Occupations', 'Textiles And Garments Trades': 'Skilled Trades Occupations', 'Weavers and knitters': 'Skilled Trades Occupations', 'Upholsterers': 'Skilled Trades Occupations', 'Leather and related trades': 'Skilled Trades Occupations', 'Tailors and dressmakers': 'Skilled Trades Occupations', 'Textiles, garments and related trades n.e.c.': 'Skilled Trades Occupations', 'Printing Trades': 'Skilled Trades Occupations', 'Originators, compositors and print preparers': 'Skilled Trades Occupations', 'Printers': 'Skilled Trades Occupations', 'Bookbinders and print finishers': 'Skilled Trades Occupations', 'Screen printers': 'Skilled Trades Occupations', 'Food Preparation Trades': 'Skilled Trades Occupations', 'Butchers, meat cutters': 'Skilled Trades Occupations', 'Bakers, flour confectioners': 'Skilled Trades Occupations', 'Fishmongers, poultry dressers': 'Skilled Trades Occupations', 'Chefs, cooks': 'Skilled Trades Occupations', 'Skilled Trades n.e.c.': 'Skilled Trades Occupations', 'Glass and ceramics makers, decorators and finishers': 'Skilled Trades Occupations', 'Furniture makers, other craft woodworkers': 'Skilled Trades Occupations', 'Pattern makers (moulds)': 'Skilled Trades Occupations', 'Musical instrument makers and tuners': 'Skilled Trades Occupations', 'Goldsmiths, silversmiths, precious stone workers': 'Skilled Trades Occupations', 'Floral arrangers, florists': 'Skilled Trades Occupations', 'Hand craft occupations n.e.c.': 'Skilled Trades Occupations', 'Caring Personal Service Occupations': 'Personal Service Occupations', 'Healthcare And Related Personal Services': 'Personal Service Occupations', 'Nursing auxiliaries and assistants': 'Personal Service Occupations', 'Ambulance staff (excluding paramedics)': 'Personal Service Occupations', 'Dental nurses': 'Personal Service Occupations', 'Houseparents and residential wardens': 'Personal Service Occupations', 'Care assistants and home carers': 'Personal Service Occupations', 'Childcare And Related Personal Services': 'Personal Service Occupations', 'Nursery nurses': 'Personal Service Occupations', 'Childminders and related occupations': 'Personal Service Occupations', 'Playgroup leaders/assistants': 'Personal Service Occupations', 'Educational assistants': 'Personal Service Occupations', 'Animal Care Services': 'Personal Service Occupations', 'Veterinary nurses and assistants': 'Personal Service Occupations', 'Animal care occupations n.e.c.': 'Personal Service Occupations', 'Leisure And Other Personal Service Occupations': 'Personal Service Occupations', 'Leisure And Travel Service Occupations': 'Personal Service Occupations', 'Sports and leisure assistants': 'Personal Service Occupations', 'Travel agents': 'Personal Service Occupations', 'Travel and tour guides': 'Personal Service Occupations', 'Air travel assistants': 'Personal Service Occupations', 'Rail travel assistants': 'Personal Service Occupations', 'Leisure and travel service occupations n.e.c.': 'Personal Service Occupations', 'Hairdressers And Related Occupations': 'Personal Service Occupations', 'Hairdressers, barbers': 'Personal Service Occupations', 'Beauticians and related occupations': 'Personal Service Occupations', 'Housekeeping Occupations': 'Personal Service Occupations', 'Housekeepers and related occupations': 'Personal Service Occupations', 'Caretakers': 'Personal Service Occupations', 'Personal Services Occupations n.e.c.': 'Personal Service Occupations', 'Undertakers and mortuary assistants': 'Personal Service Occupations', 'Pest control officers': 'Personal Service Occupations', 'Sales Occupations': 'Sales and Customer Service Occupations', 'Sales Assistants And Retail Cashiers': 'Sales and Customer Service Occupations', 'Sales and retail assistants': 'Sales and Customer Service Occupations', 'Retail cashiers and check-out operators': 'Sales and Customer Service Occupations', 'Telephone salespersons': 'Sales and Customer Service Occupations', 'Sales Related Occupations': 'Sales and Customer Service Occupations', 'Collector salespersons and credit agents': 'Sales and Customer Service Occupations', 'Debt, rent and other cash collectors': 'Sales and Customer Service Occupations', 'Roundsmen/women and van salespersons': 'Sales and Customer Service Occupations', 'Market and street traders and assistants': 'Sales and Customer Service Occupations', 'Merchandisers and window dressers': 'Sales and Customer Service Occupations', 'Sales related occupations n.e.c.': 'Sales and Customer Service Occupations', 'Customer Service Occupations': 'Sales and Customer Service Occupations', 'Call centre agents/operators': 'Sales and Customer Service Occupations', 'Customer care occupations': 'Sales and Customer Service Occupations', 'Process, Plant And Machine Operatives': 'Process, Plant and Machine Operatives', 'Process Operatives': 'Process, Plant and Machine Operatives', 'Food, drink and tobacco process operatives': 'Process, Plant and Machine Operatives', 'Glass and ceramics process operatives': 'Process, Plant and Machine Operatives', 'Textile process operatives': 'Process, Plant and Machine Operatives', 'Chemical and related process operatives': 'Process, Plant and Machine Operatives', 'Rubber process operatives': 'Process, Plant and Machine Operatives', 'Plastics process operatives': 'Process, Plant and Machine Operatives', 'Metal making and treating process operatives': 'Process, Plant and Machine Operatives', 'Electroplaters': 'Process, Plant and Machine Operatives', 'Process operatives n.e.c.': 'Process, Plant and Machine Operatives', 'Plant And Machine Operatives': 'Process, Plant and Machine Operatives', 'Paper and wood machine operatives': 'Process, Plant and Machine Operatives', 'Coal mine operatives': 'Process, Plant and Machine Operatives', 'Quarry workers and related operatives': 'Process, Plant and Machine Operatives', 'Energy plant operatives': 'Process, Plant and Machine Operatives', 'Metal working machine operatives': 'Process, Plant and Machine Operatives', 'Water and sewerage plant operatives': 'Process, Plant and Machine Operatives', 'Plant and machine operatives n.e.c.': 'Process, Plant and Machine Operatives', 'Assemblers And Routine Operatives': 'Process, Plant and Machine Operatives', 'Assemblers (electrical products)': 'Process, Plant and Machine Operatives', 'Assemblers (vehicles and metal goods)': 'Process, Plant and Machine Operatives', 'Routine inspectors and testers': 'Process, Plant and Machine Operatives', 'Weighers, graders, sorters': 'Process, Plant and Machine Operatives', 'Tyre, exhaust and windscreen fitters': 'Process, Plant and Machine Operatives', 'Clothing cutters': 'Process, Plant and Machine Operatives', 'Sewing machinists': 'Process, Plant and Machine Operatives', 'Routine laboratory testers': 'Process, Plant and Machine Operatives', 'Assemblers and routine operatives n.e.c.': 'Process, Plant and Machine Operatives', 'Construction Operatives': 'Process, Plant and Machine Operatives', 'Scaffolders, stagers, riggers': 'Process, Plant and Machine Operatives', 'Road construction operatives': 'Process, Plant and Machine Operatives', 'Rail construction and maintenance operatives': 'Process, Plant and Machine Operatives', 'Construction operatives n.e.c.': 'Process, Plant and Machine Operatives', 'Transport And Mobile Machine Drivers And Operatives': 'Process, Plant and Machine Operatives', 'Transport Drivers And Operatives': 'Process, Plant and Machine Operatives', 'Heavy goods vehicle drivers': 'Process, Plant and Machine Operatives', 'Van drivers': 'Process, Plant and Machine Operatives', 'Bus and coach drivers': 'Process, Plant and Machine Operatives', 'Taxi, cab drivers and chauffeurs': 'Process, Plant and Machine Operatives', 'Driving instructors': 'Process, Plant and Machine Operatives', 'Rail transport operatives': 'Process, Plant and Machine Operatives', 'Seafarers (merchant navy); barge, lighter and boat operatives': 'Process, Plant and Machine Operatives', 'Air transport operatives': 'Process, Plant and Machine Operatives', 'Transport operatives n.e.c.': 'Process, Plant and Machine Operatives', 'Mobile Machine Drivers And Operatives': 'Process, Plant and Machine Operatives', 'Crane drivers': 'Process, Plant and Machine Operatives', 'Fork-lift truck drivers': 'Process, Plant and Machine Operatives', 'Agricultural machinery drivers': 'Process, Plant and Machine Operatives', 'Mobile machine drivers and operatives n.e.c.': 'Process, Plant and Machine Operatives', 'Elementary Trades, Plant And Storage Related Occupations': 'Elementary Occupations', 'Elementary Agricultural Occupations': 'Elementary Occupations', 'Farm workers': 'Elementary Occupations', 'Forestry workers': 'Elementary Occupations', 'Fishing and agriculture related occupations n.e.c.': 'Elementary Occupations', 'Elementary Construction Occupations': 'Elementary Occupations', 'Labourers in building and woodworking trades': 'Elementary Occupations', 'Labourers in other construction trades n.e.c.': 'Elementary Occupations', 'Elementary Process Plant Occupations': 'Elementary Occupations', 'Labourers in foundries': 'Elementary Occupations', 'Industrial cleaning process occupations': 'Elementary Occupations', 'Printing machine minders and assistants': 'Elementary Occupations', 'Packers, bottlers, canners, fillers': 'Elementary Occupations', 'Labourers in process and plant operations n.e.c.': 'Elementary Occupations', 'Elementary Goods Storage Occupations': 'Elementary Occupations', 'Stevedores, dockers and slingers': 'Elementary Occupations', 'Other goods handling and storage occupations n.e.c.': 'Elementary Occupations', 'Elementary Administration And Service Occupations': 'Elementary Occupations', 'Elementary Administration Occupations': 'Elementary Occupations', 'Postal workers, mail sorters, messengers, couriers': 'Elementary Occupations', 'Elementary office occupations n.e.c.': 'Elementary Occupations', 'Elementary Personal Services Occupations': 'Elementary Occupations', 'Hospital porters': 'Elementary Occupations', 'Hotel porters': 'Elementary Occupations', 'Kitchen and catering assistants': 'Elementary Occupations', 'Waiters, waitresses': 'Elementary Occupations', 'Bar staff': 'Elementary Occupations', 'Leisure and theme park attendants': 'Elementary Occupations', 'Elementary personal services occupations n.e.c.': 'Elementary Occupations', 'Elementary Cleaning Occupations': 'Elementary Occupations', 'Window cleaners': 'Elementary Occupations', 'Road sweepers': 'Elementary Occupations', 'Cleaners, domestics': 'Elementary Occupations', 'Launderers, dry cleaners, pressers': 'Elementary Occupations', 'Refuse and salvage occupations': 'Elementary Occupations', 'Elementary cleaning occupations n.e.c.': 'Elementary Occupations', 'Elementary Security Occupations': 'Elementary Occupations', 'Security guards and related occupations': 'Elementary Occupations', 'Traffic wardens': 'Elementary Occupations', 'School crossing patrol attendants': 'Elementary Occupations', 'School mid-day assistants': 'Elementary Occupations', 'Car park attendants': 'Elementary Occupations', 'Elementary security occupations n.e.c.': 'Elementary Occupations', 'Elementary Sales Occupations': 'Elementary Occupations', 'Shelf fillers': 'Elementary Occupations', 'Elementary sales occupations n.e.c.': 'Elementary Occupations'}
HES_ICD_ids = {"all_icd": {"id": '41270', "time": '41280'}, "main_icd": {"id": '41202', "time": '41262'}, "second_icd": {"id": '41203', "time": None}}
disease_columns_dict = {'chapter':'diseases_within_window_icd_chapter_coding','3-char':'diseases_within_window_all_icd_first_3','block':'diseases_within_window_icd_parent_coding'}




def clean_replace_dict(replace_dict_basics):
    keys_to_remove = []
    for key in replace_dict_basics.keys():
        try:
            float_key = float(key)
            keys_to_remove.append(key)
        except:
            continue
    for key in keys_to_remove:
        replace_dict_basics.pop(key)
    return replace_dict_basics

replace_dict_basics=clean_replace_dict(replace_dict_basics)

